@echo off
rem ---------------------------------------------------------------------------
rem Start Script for the DNS Proxy client
rem ---------------------------------------------------------------------------

set "CLIENT_CONFIG=-s 127.0.0.1"

if not "%CATALINA_HOME%" == "" goto gotHome
set "DNSPROXY_HOME=%cd%"
:gotHome
if exist "%DNSPROXY_HOME%\dnsProxy.jar" goto okHome
echo The tomcat.exe was not found...
echo The DNSPROXY_HOME environment variable is not defined correctly.
echo This environment variable is needed to run this program
goto end
:okHome
rem Make sure prerequisite environment variables are set
if not "%JAVA_HOME%" == "" goto gotJdkHome
if not "%JRE_HOME%" == "" goto gotJreHome
echo Neither the JAVA_HOME nor the JRE_HOME environment variable is defined
echo Service will try to guess them from the registry.
goto okJavaHome
:gotJreHome
if not exist "%JRE_HOME%\bin\java.exe" goto noJavaHome
if not exist "%JRE_HOME%\bin\javaw.exe" goto noJavaHome
goto okJavaHome
:gotJdkHome
if not exist "%JAVA_HOME%\jre\bin\java.exe" goto noJavaHome
if not exist "%JAVA_HOME%\jre\bin\javaw.exe" goto noJavaHome
if not exist "%JAVA_HOME%\bin\javac.exe" goto noJavaHome
if not "%JRE_HOME%" == "" goto okJavaHome
set "JRE_HOME=%JAVA_HOME%\jre"
goto okJavaHome
:noJavaHome
echo The JAVA_HOME environment variable is not defined correctly
echo This environment variable is needed to run this program
echo NB: JAVA_HOME should point to a JDK not a JRE
goto end
:okJavaHome


"%JRE_HOME%\bin\java.exe" -jar "%CATALINA_HOME%\dnsProxy.jar" client %CLIENT_CONFIG%


:end

